import { useState, useEffect } from "react";
import { useMutation, useQuery } from "@tanstack/react-query";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { insertProviderSchema, insertUserSchema } from "@shared/schema";
import { z } from "zod";
import { Header, Footer } from "@/components/layout";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from "@/components/ui/form";
import { Input } from "@/components/ui/input";
import { Badge } from "@/components/ui/badge";

import { Checkbox } from "@/components/ui/checkbox";
import { Command, CommandEmpty, CommandGroup, CommandInput, CommandItem } from "@/components/ui/command";
import { Popover, PopoverContent, PopoverTrigger } from "@/components/ui/popover";
import { Plus, Star, Users, Calendar, TrendingUp, MapPin, Navigation, CreditCard, DollarSign, Building2, Shield, Check, ChevronsUpDown, Camera, User } from "lucide-react";
import { apiRequest } from "@/lib/queryClient";
import { SimpleServiceTable } from "@/components/simple-service-table";
import { GPSLocationPicker } from "@/components/gps-location-picker";
import QrScanner from 'qr-scanner';

const providerFormSchema = z.object({
  firstName: z.string().min(2, "First name must be at least 2 characters"),
  lastName: z.string().min(2, "Last name must be at least 2 characters"),
  phone: z.string().min(10, "Please enter a valid phone number"),

  businessName: z.string().min(2, "Business name is required"),
  staffCount: z.union([z.string(), z.number()]).transform((val) => {
    if (typeof val === "string") {
      if (val === "") return 1;
      const num = parseInt(val);
      return isNaN(num) ? 1 : num;
    }
    return val;
  }).pipe(z.number().min(1, "Must have at least 1 staff member").max(20, "Cannot exceed 20 staff members")),
  // Payment method selection
  paymentMethod: z.enum(["bank", "gpay", "phonepe", "paytm", "upi"], { required_error: "Please select a payment method" }),
  // Bank details (optional if UPI is selected)
  bankName: z.string().optional(),
  accountHolderName: z.string().optional(),
  accountNumber: z.string().optional(),
  routingNumber: z.string().optional().refine((val) => {
    if (!val) return true; // Optional field
    // IFSC format: 4 letters + 0 + 6 alphanumeric characters
    const ifscPattern = /^[A-Z]{4}0[A-Z0-9]{6}$/;
    return ifscPattern.test(val);
  }, "IFSC code must be in format: ABCD0123456 (4 letters + 0 + 6 characters)"),
  swiftCode: z.string().optional(),
  // UPI details (optional if bank is selected)
  upiId: z.string().optional().refine((val) => {
    if (!val) return true; // Optional field
    // Basic UPI ID validation: anything@anything
    const upiPattern = /^[\w.-]+@[\w.-]+$/;
    return upiPattern.test(val);
  }, "Please enter a valid UPI ID (e.g., yourname@paytm)"),
  acceptsCash: z.boolean().default(true),
  acceptsCard: z.boolean().default(false),
  acceptsTransfer: z.boolean().default(false),
  location: z.string().min(1, "Location is required"),
  latitude: z.number().optional(),
  longitude: z.number().optional(),
  selectedServices: z.array(z.object({
    serviceName: z.string(),
    price: z.string(),
    time: z.string(),
  })).default([]),
}).refine((data) => {
  if (data.paymentMethod === "bank") {
    return data.bankName && data.accountHolderName && data.accountNumber && data.routingNumber;
  } else if (["gpay", "phonepe", "paytm", "upi"].includes(data.paymentMethod)) {
    return data.upiId;
  }
  return false;
}, {
  message: "Please provide either complete bank details or UPI ID",
  path: ["paymentMethod"]
});

type ProviderFormData = z.infer<typeof providerFormSchema>;



const indianBanks = [
  // Public Sector Banks
  "State Bank of India (SBI)",
  "Punjab National Bank (PNB)",
  "Bank of Baroda",
  "Canara Bank", 
  "Union Bank of India",
  "Indian Bank",
  "Central Bank of India",
  "Bank of India",
  "Indian Overseas Bank",
  "UCO Bank",
  "Punjab & Sind Bank",
  "Bank of Maharashtra",
  
  // Private Sector Banks
  "HDFC Bank",
  "ICICI Bank",
  "Axis Bank",
  "Kotak Mahindra Bank",
  "YES Bank",
  "IndusInd Bank",
  "Federal Bank",
  "South Indian Bank",
  "Karur Vysya Bank",
  "Tamilnad Mercantile Bank",
  "City Union Bank",
  "Dhanlaxmi Bank",
  "RBL Bank",
  "Bandhan Bank",
  "IDFC First Bank",
  "CSB Bank",
  "DCB Bank",
  "Nainital Bank",
  
  // Regional Rural Banks
  "Jammu and Kashmir Bank",
  "Karnataka Bank",
  "Lakshmi Vilas Bank",
  "Catholic Syrian Bank",
  "Rajkot Nagarik Sahakari Bank",
  "Saraswat Bank",
  "Cosmos Bank",
  "Kerala Gramin Bank",
  "Puduvai Bharathiar Grama Bank",
  "Sarva Haryana Gramin Bank",
  "Himachal Pradesh Gramin Bank",
  "Uttar Pradesh Gramin Bank",
  "Andhra Pradesh Gramin Vikas Bank",
  "Karnataka Gramin Bank",
  "Maharashtra Gramin Bank",
  "Rajasthan Marudhara Gramin Bank",
  "Gujarat State Cooperative Bank",
  "Tamil Nadu State Cooperative Bank",
  
  // Small Finance Banks
  "AU Small Finance Bank",
  "Equitas Small Finance Bank",
  "Jana Small Finance Bank",
  "Ujjivan Small Finance Bank",
  "Suryoday Small Finance Bank",
  "ESAF Small Finance Bank",
  "North East Small Finance Bank",
  "Capital Small Finance Bank",
  "Fincare Small Finance Bank",
  "Utkarsh Small Finance Bank",
  "Unity Small Finance Bank",
  "Shivalik Small Finance Bank",
  
  // Payments Banks
  "Paytm Payments Bank",
  "Airtel Payments Bank",
  "India Post Payments Bank",
  "Jio Payments Bank",
  "NSDL Payments Bank",
  "Fino Payments Bank",
  
  // Foreign Banks (Major ones in India)
  "Citibank",
  "HSBC Bank",
  "Standard Chartered Bank",
  "Deutsche Bank",
  "Barclays Bank",
  "Bank of America",
  "DBS Bank",
  "Mizuho Bank",
  "MUFG Bank",
  "Sumitomo Mitsui Banking Corporation",
  
  // Cooperative Banks (Major ones)
  "Mumbai District Central Cooperative Bank",
  "Pune District Central Cooperative Bank",
  "Delhi State Cooperative Bank",
  "Haryana State Cooperative Bank",
  "Kerala State Cooperative Bank",
  "West Bengal State Cooperative Bank",
  "Karnataka State Cooperative Bank",
  "Andhra Pradesh State Cooperative Bank",
  
  // Other Banks
  "IDBI Bank",
  "Oriental Bank of Commerce",
  "Syndicate Bank",
  "Corporation Bank",
  "Allahabad Bank",
  "Andhra Bank",
  "Vijaya Bank",
  "Dena Bank",
  "Other"
];

export default function BecomeProvider() {
  const [locationData, setLocationData] = useState<{
    address: string;
    latitude: number;
    longitude: number;
  } | null>(null);
  const [bankOpen, setBankOpen] = useState(false);
  const [paymentMethod, setPaymentMethod] = useState<"bank" | "gpay" | "phonepe" | "paytm" | "upi">("bank");
  const [isScanning, setIsScanning] = useState(false);
  const [serviceTableData, setServiceTableData] = useState<any[]>([]);

  // No need for global services anymore - using simple table

  const form = useForm<ProviderFormData>({
    resolver: zodResolver(providerFormSchema),
    defaultValues: {
      firstName: "",
      lastName: "",
      phone: "",

      businessName: "",
      staffCount: 1,
      paymentMethod: "bank" as const,
      bankName: "",
      accountHolderName: "",
      accountNumber: "",
      routingNumber: "",
      swiftCode: "",
      upiId: "",
      acceptsCash: true,
      acceptsCard: false,
      acceptsTransfer: false,
      location: "",
      latitude: undefined,
      longitude: undefined,
      selectedServices: [],
    },
  });

  // Watch staff count for immediate UI updates
  const staffCount = form.watch("staffCount");

  const registerMutation = useMutation({
    mutationFn: async (data: ProviderFormData) => {
      console.log("Starting provider registration with data:", data);
      
      try {
        // Create user first
        const userResponse = await apiRequest("POST", "/api/auth/register", {
          firstName: data.firstName,
          lastName: data.lastName,
          phone: data.phone,
          password: "temp123", // Temporary password - will be handled by auth system
        });
        
        const userResult = await userResponse.json();
        console.log("User created:", userResult);
        
        // Then create provider profile
        const providerData = {
          userId: userResult.user.id,
          businessName: data.businessName,
          description: "New beauty service provider",
          staffCount: data.staffCount,
          bankName: data.paymentMethod === "bank" ? data.bankName : null,
          accountHolderName: data.paymentMethod === "bank" ? data.accountHolderName : null,
          accountNumber: data.paymentMethod === "bank" ? data.accountNumber : null,
          routingNumber: data.paymentMethod === "bank" ? data.routingNumber : null,
          swiftCode: data.paymentMethod === "bank" ? data.swiftCode : null,
          upiId: data.paymentMethod === "upi" ? data.upiId : null,
          acceptsCash: data.acceptsCash,
          acceptsCard: data.acceptsCard,
          acceptsTransfer: data.acceptsTransfer,
          location: data.location,
          latitude: data.latitude?.toString() || null,
          longitude: data.longitude?.toString() || null,
          specialties: [],
          portfolio: [],
          selectedServices: serviceTableData, // Include service table data in provider creation
        };
        
        console.log("Creating provider with data:", providerData);
        
        const providerResponse = await apiRequest("POST", "/api/providers", providerData);
        const providerResult = await providerResponse.json();
        
        console.log("Provider created:", providerResult);
        console.log("Services saved during provider creation:", serviceTableData.length > 0 ? "Yes" : "No");
        
        // Auto-login the user after successful registration
        const loginResponse = await apiRequest("POST", "/api/auth/login", {
          phone: data.phone,
          password: "temp123", // Temporary password - will be handled by auth system
        });
        
        const loginResult = await loginResponse.json();
        console.log("Auto-login successful:", loginResult);
        
        return { provider: providerResult, user: loginResult.user };
      } catch (error) {
        console.error("Registration error:", error);
        throw error;
      }
    },
    onSuccess: (data) => {
      // Show success notification
      alert("ðŸŽ‰ Registration Successful!\n\nâœ… Your provider account has been created\nâœ… You're now visible in the provider listings\nâœ… Clients can now discover and book your services\n\nRedirecting to your dashboard...");
      
      // Redirect to provider dashboard after successful registration
      setTimeout(() => {
        window.location.href = '/provider-dashboard';
      }, 2000);
    },
    onError: (error: any) => {
      console.error("Registration failed:", error);
    },
  });



  const handleLocationSelect = (location: { address: string; latitude: number; longitude: number }) => {
    setLocationData(location);
    form.setValue("location", location.address);
    form.setValue("latitude", location.latitude);
    form.setValue("longitude", location.longitude);
  };

  const onSubmit = (data: ProviderFormData) => {
    console.log("Form submission started with data:", data);
    console.log("Form errors:", form.formState.errors);
    console.log("Location data:", locationData);
    
    // Ensure location data is included
    if (locationData) {
      data.latitude = locationData.latitude;
      data.longitude = locationData.longitude;
      data.location = locationData.address;
    }
    
    // If no location data but manual location is provided, use that
    if (!data.location || data.location.trim() === "") {
      data.location = "Location to be updated later";
      data.latitude = 0;
      data.longitude = 0;
    }
    
    console.log("Final data being submitted:", data);
    registerMutation.mutate(data);
  };

  return (
    <div className="min-h-screen bg-cream salon-equipment-bg">
      <Header />
      
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {/* Hero Section */}
        <div className="text-center mb-12">
          <h1 className="text-4xl font-bold text-gray-800 mb-4">
            Join Salon Connect as a Provider
          </h1>
          <p className="text-xl text-gray-600 max-w-2xl mx-auto">
            Grow your beauty business by connecting with clients in your area. 
            Start accepting bookings and showcase your skills today.
          </p>
        </div>

        {/* Benefits Section */}
        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-12">
          <div className="text-center p-6 bg-white rounded-2xl shadow-lg">
            <div className="w-12 h-12 mx-auto mb-4 bg-professional-teal rounded-full flex items-center justify-center">
              <Users className="w-6 h-6 text-white" />
            </div>
            <h3 className="font-semibold mb-2">Reach More Clients</h3>
            <p className="text-sm text-gray-600">Connect with beauty enthusiasts in your area</p>
          </div>
          
          <div className="text-center p-6 bg-white rounded-2xl shadow-lg">
            <div className="w-12 h-12 mx-auto mb-4 bg-rose-gold rounded-full flex items-center justify-center">
              <Calendar className="w-6 h-6 text-white" />
            </div>
            <h3 className="font-semibold mb-2">Easy Booking</h3>
            <p className="text-sm text-gray-600">Streamlined appointment management</p>
          </div>
          
          <div className="text-center p-6 bg-white rounded-2xl shadow-lg">
            <div className="w-12 h-12 mx-auto mb-4 bg-deep-rose rounded-full flex items-center justify-center">
              <Star className="w-6 h-6 text-white" />
            </div>
            <h3 className="font-semibold mb-2">Build Reputation</h3>
            <p className="text-sm text-gray-600">Showcase reviews and build trust</p>
          </div>
          
          <div className="text-center p-6 bg-white rounded-2xl shadow-lg">
            <div className="w-12 h-12 mx-auto mb-4 bg-professional-teal rounded-full flex items-center justify-center">
              <TrendingUp className="w-6 h-6 text-white" />
            </div>
            <h3 className="font-semibold mb-2">Grow Business</h3>
            <p className="text-sm text-gray-600">Increase revenue and client base</p>
          </div>
        </div>

        {/* Registration Form */}
        <Card className="max-w-2xl mx-auto">
          <CardHeader>
            <CardTitle className="text-2xl text-center">Create Your Provider Account</CardTitle>
          </CardHeader>
          <CardContent>
            <Form {...form}>
              <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-6">
                {/* Personal Information */}
                <div className="space-y-4">
                  <h3 className="text-lg font-semibold">Personal Information</h3>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <FormField
                      control={form.control}
                      name="firstName"
                      render={({ field }) => (
                        <FormItem>
                          <FormLabel>First Name</FormLabel>
                          <FormControl>
                            <Input {...field} />
                          </FormControl>
                          <FormMessage />
                        </FormItem>
                      )}
                    />
                    
                    <FormField
                      control={form.control}
                      name="lastName"
                      render={({ field }) => (
                        <FormItem>
                          <FormLabel>Last Name</FormLabel>
                          <FormControl>
                            <Input {...field} />
                          </FormControl>
                          <FormMessage />
                        </FormItem>
                      )}
                    />
                  </div>
                  

                  

                  
                  <FormField
                    control={form.control}
                    name="phone"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Phone Number</FormLabel>
                        <FormControl>
                          <Input {...field} value={field.value || ""} />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />
                </div>

                {/* Business Information */}
                <div className="space-y-4">
                  <h3 className="text-lg font-semibold">Business Information</h3>
                  
                  <FormField
                    control={form.control}
                    name="businessName"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Business Name</FormLabel>
                        <FormControl>
                          <Input {...field} />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />

                  <FormField
                    control={form.control}
                    name="staffCount"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Number of Staff Members</FormLabel>
                        <FormControl>
                          <Input 
                            type="number" 
                            min="1" 
                            max="20" 
                            {...field}
                            onChange={(e) => {
                              const value = e.target.value;
                              if (value === "") {
                                field.onChange("");
                              } else {
                                const numValue = parseInt(value);
                                if (!isNaN(numValue)) {
                                  field.onChange(numValue);
                                }
                              }
                            }}
                            data-testid="input-staff-count"
                          />
                        </FormControl>
                        <p className="text-sm text-muted-foreground">
                          How many people can provide services simultaneously? This affects your booking capacity.
                        </p>
                        <FormMessage />
                      </FormItem>
                    )}
                  />

                  {/* Immediate Staff Slot Management Interface - Appears when staff count > 1 */}
                  {staffCount && staffCount > 1 && (
                    <div className="mt-6 p-6 bg-gradient-to-br from-purple-50 to-blue-50 rounded-lg border-2 border-purple-200">
                      <div className="flex items-center gap-3 mb-4">
                        <Users className="h-6 w-6 text-purple-600" />
                        <h4 className="text-lg font-semibold text-purple-900">Staff Slot Management</h4>
                        <span className="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium">{staffCount} Staff Members</span>
                      </div>
                      <p className="text-sm text-purple-700 mb-6">
                        Set up individual time slots for each of your {staffCount} staff members. Each person gets their own availability schedule.
                      </p>
                      
                      <div className="space-y-4 max-h-96 overflow-y-auto">
                        {Array.from({ length: staffCount }, (_, index) => {
                          const staffIndex = index + 1;
                          const timeSlots = ["09:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00"];
                          
                          return (
                            <Card key={staffIndex} className="border border-purple-200 bg-white/50">
                              <CardHeader className="pb-3">
                                <div className="flex items-center justify-between">
                                  <div className="flex items-center gap-2">
                                    <User className="h-4 w-4 text-purple-600" />
                                    <h5 className="font-medium text-purple-900">Staff Member {staffIndex}</h5>
                                  </div>
                                  <span className="px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs">
                                    9 time slots
                                  </span>
                                </div>
                              </CardHeader>
                              <CardContent className="pt-0">
                                <div className="grid grid-cols-3 md:grid-cols-9 gap-2">
                                  {timeSlots.map((time) => (
                                    <Button
                                      key={`${staffIndex}-${time}`}
                                      type="button"
                                      variant="outline"
                                      size="sm"
                                      className="text-xs bg-green-50 text-green-700 border-green-300 hover:bg-green-100"
                                    >
                                      {time}
                                    </Button>
                                  ))}
                                </div>
                                <p className="text-xs text-purple-600 mt-2">
                                  All slots available by default - customize after registration
                                </p>
                              </CardContent>
                            </Card>
                          );
                        })}
                      </div>
                      
                      <div className="mt-4 p-3 bg-purple-100 rounded-md">
                        <p className="text-sm text-purple-800">
                          <strong>Preview:</strong> This shows how your {staffCount} staff members will each get their own time slot management interface. After registration, you can customize names, enable/disable specific slots, and manage individual schedules.
                        </p>
                      </div>
                    </div>
                  )}

                  {/* Services and Rates Selection */}
                  <div className="space-y-4 mt-6">
                    <h3 className="text-lg font-semibold text-gray-900">Services & Pricing</h3>
                    <div className="p-4 bg-blue-50 rounded-lg border border-blue-200">
                      <p className="text-sm text-blue-800 mb-2">
                        <strong>Important:</strong> Fill in your services and pricing below. Only services you add here will be available for client booking.
                      </p>
                      <p className="text-xs text-blue-700">
                        You can add or modify these services anytime from your provider dashboard.
                      </p>
                    </div>
                    
                    <SimpleServiceTable 
                      onChange={(services) => {
                        setServiceTableData(services);
                        form.setValue("selectedServices", services);
                      }}
                    />
                    
                    {/* Service Count Indicator */}
                    <div className="flex items-center justify-between p-3 bg-gray-50 rounded-lg border">
                      <div className="flex items-center gap-2">
                        <div className={`w-3 h-3 rounded-full ${serviceTableData.length > 0 ? 'bg-green-500' : 'bg-gray-300'}`} />
                        <span className="text-sm font-medium text-gray-700">
                          Services Configured: {serviceTableData.length}
                        </span>
                      </div>
                      <span className="text-xs text-gray-500">
                        {serviceTableData.length === 0 ? 'Add at least one service to continue' : 'Ready for registration'}
                      </span>
                    </div>
                  </div>

                  {/* Payment Method Selection */}
                  <div className="space-y-4 mt-6 p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg border border-blue-200">
                    <div className="flex items-center gap-2 mb-3">
                      <div className="text-blue-600 text-2xl">ðŸ’³</div>
                      <h4 className="text-lg font-semibold text-blue-800">Payment Information</h4>
                    </div>
                    
                    {/* Payment Method Toggle */}
                    <FormField
                      control={form.control}
                      name="paymentMethod"
                      render={({ field }) => (
                        <FormItem>
                          <FormLabel className="text-blue-700">Choose Payment Method</FormLabel>
                          <FormControl>
                            <div className="grid grid-cols-1 gap-3">
                              {/* Bank Account Option */}
                              <div 
                                className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${
                                  field.value === "bank" 
                                    ? "border-blue-500 bg-blue-100" 
                                    : "border-gray-300 bg-white hover:border-blue-300"
                                }`}
                                onClick={() => {
                                  field.onChange("bank");
                                  setPaymentMethod("bank");
                                }}
                              >
                                <div className="flex items-center gap-2">
                                  <Building2 className="w-5 h-5 text-blue-600" />
                                  <span className="font-medium">Bank Account</span>
                                </div>
                                <p className="text-sm text-gray-600 mt-1">Traditional bank transfer</p>
                              </div>
                              
                              {/* UPI Options Grid */}
                              <div className="grid grid-cols-2 gap-3">
                                {/* Google Pay */}
                                <div 
                                  className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${
                                    field.value === "gpay" 
                                      ? "border-green-500 bg-green-100" 
                                      : "border-gray-300 bg-white hover:border-green-300"
                                  }`}
                                  onClick={() => {
                                    field.onChange("gpay");
                                    setPaymentMethod("gpay");
                                  }}
                                >
                                  <div className="flex items-center gap-2">
                                    <div className="w-5 h-5 text-green-600">ðŸ’³</div>
                                    <span className="font-medium">Google Pay</span>
                                  </div>
                                  <p className="text-sm text-gray-600 mt-1">GPay UPI</p>
                                </div>
                                
                                {/* PhonePe */}
                                <div 
                                  className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${
                                    field.value === "phonepe" 
                                      ? "border-purple-500 bg-purple-100" 
                                      : "border-gray-300 bg-white hover:border-purple-300"
                                  }`}
                                  onClick={() => {
                                    field.onChange("phonepe");
                                    setPaymentMethod("phonepe");
                                  }}
                                >
                                  <div className="flex items-center gap-2">
                                    <div className="w-5 h-5 text-purple-600">ðŸ“±</div>
                                    <span className="font-medium">PhonePe</span>
                                  </div>
                                  <p className="text-sm text-gray-600 mt-1">PhonePe UPI</p>
                                </div>
                                
                                {/* Paytm */}
                                <div 
                                  className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${
                                    field.value === "paytm" 
                                      ? "border-blue-500 bg-blue-100" 
                                      : "border-gray-300 bg-white hover:border-blue-300"
                                  }`}
                                  onClick={() => {
                                    field.onChange("paytm");
                                    setPaymentMethod("paytm");
                                  }}
                                >
                                  <div className="flex items-center gap-2">
                                    <div className="w-5 h-5 text-blue-600">ðŸ’°</div>
                                    <span className="font-medium">Paytm</span>
                                  </div>
                                  <p className="text-sm text-gray-600 mt-1">Paytm UPI</p>
                                </div>
                                
                                {/* Other UPI */}
                                <div 
                                  className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${
                                    field.value === "upi" 
                                      ? "border-orange-500 bg-orange-100" 
                                      : "border-gray-300 bg-white hover:border-orange-300"
                                  }`}
                                  onClick={() => {
                                    field.onChange("upi");
                                    setPaymentMethod("upi");
                                  }}
                                >
                                  <div className="flex items-center gap-2">
                                    <CreditCard className="w-5 h-5 text-orange-600" />
                                    <span className="font-medium">Other UPI</span>
                                  </div>
                                  <p className="text-sm text-gray-600 mt-1">Any UPI app</p>
                                </div>
                              </div>
                            </div>
                          </FormControl>
                          <FormMessage />
                        </FormItem>
                      )}
                    />

                    {/* Conditional Form Fields */}
                    {paymentMethod === "bank" && (
                      <div className="space-y-4 p-4 bg-blue-50 rounded border border-blue-200">
                        <h5 className="font-medium text-blue-800 flex items-center gap-2">
                          <Building2 className="w-4 h-4" />
                          Bank Account Details
                        </h5>
                        <p className="text-sm text-blue-600 mb-4">
                          Add your Indian bank details so clients can pay for your services.
                        </p>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <FormField
                        control={form.control}
                        name="bankName"
                        render={({ field }) => (
                          <FormItem className="flex flex-col">
                            <FormLabel className="text-blue-700">Select Your Bank</FormLabel>
                            <Popover open={bankOpen} onOpenChange={setBankOpen}>
                              <PopoverTrigger asChild>
                                <FormControl>
                                  <Button
                                    variant="outline"
                                    role="combobox"
                                    aria-expanded={bankOpen}
                                    className="w-full justify-between border-blue-300 focus:border-blue-500"
                                  >
                                    {field.value
                                      ? indianBanks.find((bank) => bank === field.value)
                                      : "Type to search banks..."}
                                    <ChevronsUpDown className="ml-2 h-4 w-4 shrink-0 opacity-50" />
                                  </Button>
                                </FormControl>
                              </PopoverTrigger>
                              <PopoverContent className="w-[400px] p-0">
                                <Command>
                                  <CommandInput placeholder="Search banks (e.g., type 'j' for Jammu Kashmir Bank)..." />
                                  <CommandEmpty>No bank found. Type to search from 80+ Indian banks.</CommandEmpty>
                                  <CommandGroup className="max-h-[300px] overflow-y-auto">
                                    {indianBanks.map((bank, index) => (
                                      <CommandItem
                                        key={`${bank}-${index}`}
                                        value={bank}
                                        onSelect={() => {
                                          field.onChange(bank);
                                          setBankOpen(false);
                                        }}
                                      >
                                        <Check
                                          className={`mr-2 h-4 w-4 ${
                                            field.value === bank ? "opacity-100" : "opacity-0"
                                          }`}
                                        />
                                        {bank}
                                      </CommandItem>
                                    ))}
                                  </CommandGroup>
                                </Command>
                              </PopoverContent>
                            </Popover>
                            <FormMessage />
                          </FormItem>
                        )}
                      />

                      <FormField
                        control={form.control}
                        name="accountHolderName"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel className="text-blue-700">Account Holder Name</FormLabel>
                            <FormControl>
                              <Input 
                                placeholder="Full name on account"
                                className="border-blue-300 focus:border-blue-500"
                                {...field} 
                              />
                            </FormControl>
                            <FormMessage />
                          </FormItem>
                        )}
                      />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <FormField
                        control={form.control}
                        name="accountNumber"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel className="text-blue-700">Account Number</FormLabel>
                            <FormControl>
                              <Input 
                                type="password"
                                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                                className="border-blue-300 focus:border-blue-500"
                                {...field} 
                              />
                            </FormControl>
                            <FormMessage />
                          </FormItem>
                        )}
                      />

                      <FormField
                        control={form.control}
                        name="routingNumber"
                        render={({ field }) => (
                          <FormItem>
                            <FormLabel className="text-blue-700">IFSC Code</FormLabel>
                            <FormControl>
                              <Input 
                                placeholder="HDFC0001234"
                                className="border-blue-300 focus:border-blue-500 uppercase"
                                {...field} 
                                onChange={(e) => {
                                  const value = e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
                                  field.onChange(value);
                                }}
                                maxLength={11}
                              />
                            </FormControl>
                            <FormMessage />
                            <p className="text-xs text-blue-600">
                              Format: 4 letters + 0 + 6 numbers (e.g., HDFC0001234)
                            </p>
                          </FormItem>
                        )}
                      />
                    </div>

                    <FormField
                      control={form.control}
                      name="swiftCode"
                      render={({ field }) => (
                        <FormItem>
                          <FormLabel className="text-blue-700">UPI ID (Optional)</FormLabel>
                          <FormControl>
                            <Input 
                              placeholder="e.g., yourname@paytm, yourname@phonepe"
                              className="border-blue-300 focus:border-blue-500"
                              {...field} 
                            />
                          </FormControl>
                          <FormMessage />
                          <p className="text-xs text-blue-600">
                            Enter your UPI ID for instant payments
                          </p>
                        </FormItem>
                      )}
                    />

                    {/* Payment Methods */}
                    <div className="space-y-3">
                      <FormLabel className="text-blue-700">Accepted Payment Methods</FormLabel>
                      
                      <div className="space-y-3">
                        <FormField
                          control={form.control}
                          name="acceptsCash"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center space-x-3 space-y-0">
                              <FormControl>
                                <Checkbox
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                              <div className="flex items-center gap-2">
                                <DollarSign className="w-4 h-4 text-green-600" />
                                <FormLabel className="text-sm font-normal">
                                  Cash payments at appointment
                                </FormLabel>
                              </div>
                            </FormItem>
                          )}
                        />

                        <FormField
                          control={form.control}
                          name="acceptsCard"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center space-x-3 space-y-0">
                              <FormControl>
                                <Checkbox
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                              <div className="flex items-center gap-2">
                                <CreditCard className="w-4 h-4 text-blue-600" />
                                <FormLabel className="text-sm font-normal">
                                  Credit/Debit card payments
                                </FormLabel>
                              </div>
                            </FormItem>
                          )}
                        />

                        <FormField
                          control={form.control}
                          name="acceptsTransfer"
                          render={({ field }) => (
                            <FormItem className="flex flex-row items-center space-x-3 space-y-0">
                              <FormControl>
                                <Checkbox
                                  checked={field.value}
                                  onCheckedChange={field.onChange}
                                />
                              </FormControl>
                              <div className="flex items-center gap-2">
                                <Building2 className="w-4 h-4 text-purple-600" />
                                <FormLabel className="text-sm font-normal">
                                  Bank transfers
                                </FormLabel>
                              </div>
                            </FormItem>
                          )}
                        />
                      </div>
                    </div>

                    <div className="bg-white p-3 rounded border border-blue-200">
                      <div className="flex items-center gap-2 mb-2">
                        <Shield className="w-4 h-4 text-blue-600" />
                        <span className="text-sm font-medium text-blue-800">Security Notice</span>
                      </div>
                      <p className="text-xs text-blue-600">
                        Your bank details are encrypted and stored securely. Only you can view and edit this information.
                      </p>
                    </div>
                      </div>
                    )}

                    {/* UPI Options */}
                    {["gpay", "phonepe", "paytm", "upi"].includes(paymentMethod) && (
                      <div className="space-y-4 p-4 bg-green-50 rounded border border-green-200">
                        <h5 className="font-medium text-green-800 flex items-center gap-2">
                          <CreditCard className="w-4 h-4" />
                          {paymentMethod === "gpay" ? "Google Pay" : 
                           paymentMethod === "phonepe" ? "PhonePe" :
                           paymentMethod === "paytm" ? "Paytm" : "UPI"} Payment Details
                        </h5>
                        <p className="text-sm text-green-600 mb-4">
                          Add your {paymentMethod === "gpay" ? "Google Pay" : 
                                   paymentMethod === "phonepe" ? "PhonePe" :
                                   paymentMethod === "paytm" ? "Paytm" : "UPI"} ID for quick and easy payments from clients.
                        </p>

                        <FormField
                          control={form.control}
                          name="upiId"
                          render={({ field }) => (
                            <FormItem>
                              <FormLabel className="text-green-700">UPI ID</FormLabel>
                              <div className="flex gap-2">
                                <FormControl>
                                  <Input 
                                    placeholder={
                                      paymentMethod === "gpay" ? "yourname@okaxis or yourname@okicici" :
                                      paymentMethod === "phonepe" ? "yourname@ybl or yourname@ibl" :
                                      paymentMethod === "paytm" ? "yourname@paytm" :
                                      "yourname@bankname (any UPI app)"
                                    }
                                    className="border-green-300 focus:border-green-500 flex-1"
                                    {...field} 
                                  />
                                </FormControl>
                                <Button
                                  type="button"
                                  variant="outline"
                                  size="sm"
                                  className="border-green-300 text-green-600 hover:bg-green-50"
                                  disabled={isScanning}
                                  onClick={async () => {
                                    try {
                                      setIsScanning(true);
                                      
                                      // Check if device has camera
                                      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                                        alert("Camera access is not available. Please enter UPI ID manually.");
                                        setIsScanning(false);
                                        return;
                                      }

                                      // Create scanner modal
                                      const modal = document.createElement('div');
                                      modal.id = 'qr-scanner-modal';
                                      modal.style.cssText = `
                                        position: fixed;
                                        top: 0;
                                        left: 0;
                                        width: 100%;
                                        height: 100%;
                                        background: black;
                                        z-index: 10000;
                                        display: flex;
                                        flex-direction: column;
                                        align-items: center;
                                        justify-content: center;
                                      `;
                                      
                                      // Instructions
                                      const header = document.createElement('div');
                                      header.style.cssText = `
                                        color: white;
                                        text-align: center;
                                        padding: 20px;
                                        font-size: 18px;
                                        position: absolute;
                                        top: 20px;
                                        width: 100%;
                                        z-index: 10001;
                                      `;
                                      header.innerHTML = `
                                        <h3 style="margin: 0 0 10px 0;">Scan UPI QR Code</h3>
                                        <p style="margin: 0; font-size: 14px; opacity: 0.8;">Point camera at UPI payment QR code</p>
                                      `;
                                      
                                      // Video container
                                      const videoContainer = document.createElement('div');
                                      videoContainer.style.cssText = `
                                        position: relative;
                                        width: 90vw;
                                        height: 90vw;
                                        max-width: 350px;
                                        max-height: 350px;
                                        border: 3px solid #10b981;
                                        border-radius: 15px;
                                        overflow: hidden;
                                        background: black;
                                      `;
                                      
                                      // Video element
                                      const video = document.createElement('video');
                                      video.style.cssText = `
                                        width: 100%;
                                        height: 100%;
                                        object-fit: cover;
                                        transform: scaleX(-1);
                                      `;
                                      video.setAttribute('autoplay', 'true');
                                      video.setAttribute('playsinline', 'true');
                                      video.setAttribute('muted', 'true');
                                      video.muted = true;
                                      video.playsInline = true;
                                      
                                      // Scan overlay
                                      const scanOverlay = document.createElement('div');
                                      scanOverlay.style.cssText = `
                                        position: absolute;
                                        top: 50%;
                                        left: 50%;
                                        transform: translate(-50%, -50%);
                                        width: 200px;
                                        height: 200px;
                                        border: 2px solid rgba(16, 185, 129, 0.8);
                                        border-radius: 10px;
                                        pointer-events: none;
                                      `;
                                      
                                      // Corner indicators
                                      const corners = [
                                        { top: '-10px', left: '-10px', borderTop: '4px solid #10b981', borderLeft: '4px solid #10b981' },
                                        { top: '-10px', right: '-10px', borderTop: '4px solid #10b981', borderRight: '4px solid #10b981' },
                                        { bottom: '-10px', left: '-10px', borderBottom: '4px solid #10b981', borderLeft: '4px solid #10b981' },
                                        { bottom: '-10px', right: '-10px', borderBottom: '4px solid #10b981', borderRight: '4px solid #10b981' }
                                      ];
                                      
                                      corners.forEach(corner => {
                                        const cornerEl = document.createElement('div');
                                        cornerEl.style.cssText = `
                                          position: absolute;
                                          width: 20px;
                                          height: 20px;
                                          ${Object.entries(corner).map(([k, v]) => `${k}: ${v}`).join('; ')};
                                        `;
                                        scanOverlay.appendChild(cornerEl);
                                      });
                                      
                                      // Close button
                                      const closeBtn = document.createElement('button');
                                      closeBtn.textContent = 'Close';
                                      closeBtn.style.cssText = `
                                        position: absolute;
                                        bottom: 30px;
                                        left: 50%;
                                        transform: translateX(-50%);
                                        padding: 12px 24px;
                                        background: #10b981;
                                        color: white;
                                        border: none;
                                        border-radius: 8px;
                                        font-size: 16px;
                                        cursor: pointer;
                                        z-index: 10001;
                                      `;
                                      
                                      // Assemble modal
                                      videoContainer.appendChild(video);
                                      videoContainer.appendChild(scanOverlay);
                                      modal.appendChild(header);
                                      modal.appendChild(videoContainer);
                                      modal.appendChild(closeBtn);
                                      document.body.appendChild(modal);

                                      // Start QR Scanner
                                      const qrScanner = new QrScanner(
                                        video,
                                        (result) => {
                                          console.log('QR scanned:', result.data);
                                          
                                          let upiId = '';
                                          let accountHolderName = '';
                                          
                                          try {
                                            const data = result.data;
                                            
                                            // Extract UPI details
                                            if (data.includes('upi://pay?')) {
                                              const urlParams = new URLSearchParams(data.split('?')[1]);
                                              upiId = urlParams.get('pa') || '';
                                              accountHolderName = urlParams.get('pn') || urlParams.get('tn') || '';
                                            } else if (data.includes('@')) {
                                              upiId = data.trim();
                                              const namePart = upiId.split('@')[0];
                                              if (namePart && !namePart.match(/^\d+$/)) {
                                                accountHolderName = namePart.replace(/[._]/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                                              }
                                            }
                                            
                                            if (upiId && upiId.includes('@')) {
                                              field.onChange(upiId);
                                              
                                              if (accountHolderName) {
                                                const currentAccountHolder = form.getValues('accountHolderName');
                                                if (!currentAccountHolder) {
                                                  form.setValue('accountHolderName', accountHolderName);
                                                }
                                                
                                                const currentBusiness = form.getValues('businessName');
                                                if (!currentBusiness) {
                                                  form.setValue('businessName', `${accountHolderName}'s Salon`);
                                                }
                                              }
                                              
                                              alert(`UPI ID scanned: ${upiId}${accountHolderName ? `\nAccount holder: ${accountHolderName}` : ''}`);
                                            } else {
                                              alert('No valid UPI ID found. Please try again or enter manually.');
                                            }
                                          } catch (error) {
                                            console.error('Scan error:', error);
                                            alert('Could not extract UPI ID. Please enter manually.');
                                          }
                                          
                                          // Cleanup
                                          qrScanner.stop();
                                          qrScanner.destroy();
                                          document.body.removeChild(modal);
                                          setIsScanning(false);
                                        },
                                        {
                                          preferredCamera: 'environment',
                                          maxScansPerSecond: 5,
                                          highlightScanRegion: false,
                                          highlightCodeOutline: false
                                        }
                                      );

                                      // Event handlers
                                      const cleanup = () => {
                                        try {
                                          qrScanner.stop();
                                          qrScanner.destroy();
                                        } catch (e) {
                                          console.log('Cleanup error:', e);
                                        }
                                        if (document.body.contains(modal)) {
                                          document.body.removeChild(modal);
                                        }
                                        setIsScanning(false);
                                      };
                                      
                                      closeBtn.onclick = cleanup;
                                      modal.onclick = (e) => {
                                        if (e.target === modal) cleanup();
                                      };
                                      
                                      // Start scanner
                                      try {
                                        await qrScanner.start();
                                        console.log('QR Scanner started successfully');
                                      } catch (scanError) {
                                        console.error('Scanner start failed:', scanError);
                                        alert('Failed to start camera. Please check permissions.');
                                        cleanup();
                                      }
                                      
                                    } catch (error) {
                                      console.error('Scanner error:', error);
                                      alert('Camera not available. Please enter UPI ID manually.');
                                      setIsScanning(false);
                                    }
                                  }}
                                  title="Scan QR Code for UPI ID"
                                >
                                  {isScanning ? (
                                    <div className="w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full animate-spin" />
                                  ) : (
                                    <Camera className="w-4 h-4" />
                                  )}
                                </Button>
                              </div>
                              <FormMessage />
                              <div className="flex items-start gap-2 mt-2">
                                <div className="text-green-600 text-sm">ðŸ’¡</div>
                                <div className="text-xs text-green-600">
                                  <p>Click camera icon to scan UPI QR code or enter manually</p>
                                  <p className="mt-1">Scanner will auto-fill UPI ID and account holder name</p>
                                  <p className="mt-1">Examples: 9876543210@paytm, yourname@googlepay</p>
                                </div>
                              </div>
                            </FormItem>
                          )}
                        />

                        <div className="bg-white p-3 rounded border border-green-200">
                          <div className="flex items-center gap-2 mb-2">
                            <Shield className="w-4 h-4 text-green-600" />
                            <span className="text-sm font-medium text-green-800">UPI Benefits</span>
                          </div>
                          <p className="text-xs text-green-600">
                            âœ“ Instant payments âœ“ No bank details needed âœ“ Secure transactions
                          </p>
                        </div>
                      </div>
                    )}
                  </div>
                  
                  {/* Interactive GPS Location Map */}
                  <div className="space-y-3">
                    <GPSLocationPicker
                      onLocationSelect={handleLocationSelect}
                      initialLocation={locationData}
                    />
                      <Button
                        type="button"
                        variant="outline"
                        onClick={async () => {
                          console.log("Starting location detection...");
                          
                          // Check if geolocation is supported
                          if (!navigator.geolocation) {
                            alert("Location detection is not supported by your browser. Please enter your address manually.");
                            return;
                          }

                          // Check if we're on HTTPS, localhost, or Replit domain (all allowed for geolocation)
                          const isSecure = location.protocol === 'https:' || 
                                         location.hostname === 'localhost' || 
                                         location.hostname === '127.0.0.1' ||
                                         location.hostname.includes('.replit.app') ||
                                         location.hostname.includes('.replit.dev');
                          
                          if (!isSecure) {
                            alert("Location detection requires a secure connection. Please enter your address manually.");
                            return;
                          }

                          try {
                            console.log("Requesting geolocation permission...");
                            
                            // First check permissions
                            if ('permissions' in navigator) {
                              const permission = await navigator.permissions.query({name: 'geolocation'});
                              console.log("Geolocation permission status:", permission.state);
                              
                              if (permission.state === 'denied') {
                                alert("Location access is denied. Please enable location permissions in your browser settings and try again.");
                                return;
                              }
                            }

                            // Request location with improved settings
                            const position = await new Promise<GeolocationPosition>((resolve, reject) => {
                              const options = {
                                enableHighAccuracy: false, // Changed to false for better compatibility
                                timeout: 15000, // Increased timeout
                                maximumAge: 600000 // Allow cached location for 10 minutes
                              };
                              
                              console.log("Calling getCurrentPosition with options:", options);
                              
                              navigator.geolocation.getCurrentPosition(
                                (pos) => {
                                  console.log("Location obtained:", pos.coords);
                                  resolve(pos);
                                },
                                (err) => {
                                  console.error("Geolocation error:", err);
                                  reject(err);
                                },
                                options
                              );
                            });

                            const lat = position.coords.latitude.toFixed(6);
                            const lng = position.coords.longitude.toFixed(6);
                            console.log("Location coordinates:", { lat, lng });
                            
                            // Try multiple geocoding services for better reliability
                            let address = `${lat}, ${lng}`;
                            
                            try {
                              console.log("Attempting reverse geocoding...");
                              
                              // Try OpenStreetMap first
                              const osmResponse = await fetch(
                                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`,
                                {
                                  headers: {
                                    'User-Agent': 'BookMyLook Beauty App'
                                  }
                                }
                              );
                              
                              if (osmResponse.ok) {
                                const osmData = await osmResponse.json();
                                if (osmData.display_name) {
                                  address = osmData.display_name;
                                  console.log("OSM geocoding successful:", address);
                                } else {
                                  console.log("OSM geocoding returned no address");
                                }
                              } else {
                                console.log("OSM geocoding failed with status:", osmResponse.status);
                              }
                            } catch (geocodeError) {
                              console.error("Geocoding error:", geocodeError);
                              // Use coordinates as fallback
                              address = `Business Location: ${lat}, ${lng}`;
                            }
                            
                            const location = {
                              address: address,
                              latitude: position.coords.latitude,
                              longitude: position.coords.longitude
                            };
                            
                            console.log("Setting location data:", location);
                            handleLocationSelect(location);
                            
                            const shortAddress = address.length > 80 ? address.substring(0, 80) + "..." : address;
                            alert(`âœ… Location detected successfully!\nðŸ“ ${shortAddress}`);
                            
                          } catch (error: any) {
                            console.error("Location detection failed:", error);
                            
                            let errorMessage = "Unable to detect location. ";
                            
                            if (error.code) {
                              switch(error.code) {
                                case 1: // PERMISSION_DENIED
                                  errorMessage += "Please allow location access when prompted by your browser, or enter your address manually.";
                                  break;
                                case 2: // POSITION_UNAVAILABLE
                                  errorMessage += "Your location is currently unavailable. Please check your GPS/WiFi and try again, or enter your address manually.";
                                  break;
                                case 3: // TIMEOUT
                                  errorMessage += "Location request timed out. Please try again or enter your address manually.";
                                  break;
                                default:
                                  errorMessage += "An unknown error occurred. Please enter your address manually.";
                              }
                            } else {
                              errorMessage += "Please enter your address manually.";
                            }
                            
                            alert(errorMessage);
                          }
                        }}
                        className="text-sm flex items-center gap-2"
                      >
                        <MapPin className="w-4 h-4" />
                        Auto-detect my location
                      </Button>
                      
                      <p className="text-xs text-gray-500 mt-2">
                        ðŸ“ Click to automatically detect your current location. Your browser will ask for permission. 
                        Make sure location services are enabled on your device.
                      </p>
                      
                      {locationData && (
                        <div className="mt-3 p-3 bg-green-50 border border-green-200 rounded-lg">
                          <div className="flex items-start gap-2">
                            <MapPin className="w-4 h-4 text-green-600 mt-0.5 flex-shrink-0" />
                            <div className="text-sm">
                              <p className="font-medium text-green-800">Location detected:</p>
                              <p className="text-green-700 break-words">{locationData.address}</p>
                              <p className="text-xs text-green-600 mt-1">
                                Coordinates: {locationData.latitude.toFixed(4)}, {locationData.longitude.toFixed(4)}
                              </p>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                  

                </div>

                <Button 
                  type="submit" 
                  className="w-full bg-gradient-to-r from-rose-500 to-pink-600 hover:from-rose-600 hover:to-pink-700 text-white font-bold py-4 rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl"
                  disabled={registerMutation.isPending}
                  data-testid="button-register-provider"
                >
                  {registerMutation.isPending ? (
                    <div className="flex items-center justify-center gap-2">
                      <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" />
                      Registering Your Beauty Business...
                    </div>
                  ) : (
                    <div className="flex items-center justify-center gap-2">
                      <Building2 className="w-5 h-5" />
                      ðŸŽ‰ Register as Beauty Provider
                    </div>
                  )}
                </Button>
              </form>
            </Form>
          </CardContent>
        </Card>
      </div>

      <Footer />
    </div>
  );
}
